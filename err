package com.finalproject.internMgmtSystem.dto;

import jakarta.validation.constraints.*;

public class StipendDto {

	@NotNull(message = "User ID is required")
	private Long userId;

	@NotBlank(message = "User name is required")
	private String userName;

	@NotBlank(message = "Payment mode is required")
	private String paymentMode;

	@NotNull(message = "Amount is required")
	@DecimalMin(value = "5000.0", message = "Amount must be greater than 0")
	private Double amount;

	public StipendDto() {
	}

	public StipendDto(@NotNull(message = "User ID is required") Long userId,
			@NotBlank(message = "User name is required") String userName,
			@NotBlank(message = "Payment mode is required") String paymentMode,
			@NotNull(message = "Amount is required") @DecimalMin(value = "1.0", message = "Amount must be greater than 0") Double amount) {
		super();
		this.userId = userId;
		this.userName = userName;
		this.paymentMode = paymentMode;
		this.amount = amount;
	}

	public Long getUserId() {
		return userId;
	}

	public void setUserId(Long userId) {
		this.userId = userId;
	}

	public String getUserName() {
		return userName;
	}

	public void setUserName(String userName) {
		this.userName = userName;
	}

	public String getPaymentMode() {
		return paymentMode;
	}

	public void setPaymentMode(String paymentMode) {
		this.paymentMode = paymentMode;
	}

	public Double getAmount() {
		return amount;
	}

	public void setAmount(Double amount) {
		this.amount = amount;
	}

	// getters & setters
}


import React, { useEffect, useState } from "react";
import { giveStipend, getUsers } from "../../api/adminApi";
import Navbar from "../../components/Navbar";
import Sidebar from "../../components/Sidebar";

export default function GiveStipend() {
  const [form, setForm] = useState({
    userId: "",
    userName: "",
    paymentMode: "",
    amount: 0,
  });

  const [users, setUsers] = useState([]);
  const [msg, setMsg] = useState("");

  useEffect(() => {
    fetchUsers();
  }, []);

  const fetchUsers = async () => {
    try {
      const res = await getUsers();
      setUsers(res.data);
    } catch (e) {
      console.error("Failed to load users");
    }
  };

  const handleUserSelect = (e) => {
    const selectedId = e.target.value;
    const user = users.find((u) => `${u.userId}` === selectedId);

    if (user) {
      setForm({
        ...form,
        userId: user.userId,
        userName: user.userName, // ðŸ‘ˆ Auto-fill name
      });
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    try {
      await giveStipend({
        ...form,
        userId: Number(form.userId),
        amount: Number(form.amount),
      });
      setMsg("Stipend recorded successfully!");
    } catch (e) {
      setMsg(e?.response?.data || e.message);
    }
  };

  return (
    <div className="layout">
      <Navbar />
      <Sidebar items={[{ to: "/admin/dashboard", label: "Dashboard" }]} />

      <div className="main">
        <h3>Give Stipend</h3>

        {msg && <div className="info">{msg}</div>}

        <form className="small-form" onSubmit={handleSubmit}>
          
          {/* ðŸ‘‡ Dropdown for Selecting User */}
          <select value={form.userId} onChange={handleUserSelect} required>
            <option value="">Select User</option>
            {users.map((u) => (
              <option key={u.userId} value={u.userId}>
                {u.userName} (ID: {u.userId})
              </option>
            ))}
          </select>

          {/* Auto-filled username ðŸ‘‡ */}
          <input
            type="text"
            placeholder="User Name"
            value={form.userName}
            readOnly
          />

          <input
            placeholder="Payment Mode"
            value={form.paymentMode}
            onChange={(e) =>
              setForm({ ...form, paymentMode: e.target.value })
            }
            required
          />

          <input
            type="number"
            placeholder="Amount"
            value={form.amount}
            onChange={(e) => setForm({ ...form, amount: e.target.value })}
            required
          />

          <button className="btn" type="submit">
            Give Stipend
          </button>
        </form>
      </div>
    </div>
  );
}


xperience: https://react.dev/link/react-devtools
:9090/api/admin/stipend:1   Failed to load resource: the server responded with a status of 400 ()
react-dom-client.development.js:6099  Uncaught Error: Objects are not valid as a React child (found: object with keys {amount}). If you meant to render a collection of children, use an array instead.
    at throwOnInvalidObjectTypeImpl (react-dom-client.development.js:6099:1)
    at throwOnInvalidObjectType (react-dom-client.development.js:6109:1)
    at reconcileChildFibersImpl (react-dom-client.development.js:7058:1)
    at react-dom-client.development.js:7098:1
    at reconcileChildren (react-dom-client.development.js:9699:1)
    at beginWork (react-dom-client.development.js:11988:1)
    at runWithFiberInDEV (react-dom-client.development.js:870:1)
    at performUnitOfWork (react-dom-client.development.js:17639:1)
    at workLoopSync (react-dom-client.development.js:17469:1)
    at renderRootSync (react-dom-client.development.js:17450:1)
react-dom-client.development.js:9362  An error occurred in the <div> component.

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://react.dev/link/error-boundaries to learn more about error boundaries.

defaultOnUncaughtError @ react-dom-client.development.js:9362


ERROR
Objects are not valid as a React child (found: object with keys {amount}). If you meant to render a collection of children, use an array instead.
    at throwOnInvalidObjectTypeImpl (http://localhost:3000/static/js/bundle.js:31603:11)
    at throwOnInvalidObjectType (http://localhost:3000/static/js/bundle.js:31607:106)
    at reconcileChildFibersImpl (http://localhost:3000/static/js/bundle.js:31930:9)
    at http://localhost:3000/static/js/bundle.js:31942:31
    at reconcileChildren (http://localhost:3000/static/js/bundle.js:33501:115)
    at beginWork (http://localhost:3000/static/js/bundle.js:34317:1565)
    at runWithFiberInDEV (http://localhost:3000/static/js/bundle.js:28769:68)
    at performUnitOfWork (http://localhost:3000/static/js/bundle.js:36678:93)
    at workLoopSync (http://localhost:3000/static/js/bundle.js:36573:38)
    at renderRootSync (http://localhost:3000/static/js/bundle.js:36558:7)
